<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ECellEngine: ECellEngine::Solvers::ODE::Stepper Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ECellEngine<span id="projectnumber">&#160;v0.5.0-alpha</span>
   </div>
   <div id="projectbrief">TODO</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ECellEngine::Solvers::ODE::Stepper Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Structure to control the step size of an ODE solver.  
 <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_stepper_8hpp_source.html">Stepper.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6f4d6dc7cc16fc7adc1eaa7097fb297a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a6f4d6dc7cc16fc7adc1eaa7097fb297a">ComputeDenseOutputIncrement</a> (const float _bsp[], const float _theta, const float _ks[], const unsigned _eqIdx, const unsigned short _order, const unsigned short _stage)</td></tr>
<tr class="memdesc:a6f4d6dc7cc16fc7adc1eaa7097fb297a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the dense output increment.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a6f4d6dc7cc16fc7adc1eaa7097fb297a">More...</a><br /></td></tr>
<tr class="separator:a6f4d6dc7cc16fc7adc1eaa7097fb297a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7bc6672affe2fc1cf7172b814d2ed3c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab7bc6672affe2fc1cf7172b814d2ed3c">ComputeDenseOutputTime</a> (const float _t, const float _t0, const float _t1) const noexcept</td></tr>
<tr class="memdesc:ab7bc6672affe2fc1cf7172b814d2ed3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gives the position of <code>_t</code> in the interval [<code>_t0</code>, <code>_t1</code>] as a value between 0 and 1.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab7bc6672affe2fc1cf7172b814d2ed3c">More...</a><br /></td></tr>
<tr class="separator:ab7bc6672affe2fc1cf7172b814d2ed3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd912a085784a578e3aab228d5e7c678"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#acd912a085784a578e3aab228d5e7c678">ComputeError</a> (float _y0[], float _yEst1[], float _yEst2[], unsigned short _count) noexcept</td></tr>
<tr class="memdesc:acd912a085784a578e3aab228d5e7c678"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the error of the steps that produced the estimations stored in <code>_yEst1</code> and <code>_yEst2</code> from <code>_y0</code>.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#acd912a085784a578e3aab228d5e7c678">More...</a><br /></td></tr>
<tr class="separator:acd912a085784a578e3aab228d5e7c678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74f3867f345e30ba236eeefc5c7a7ec"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab74f3867f345e30ba236eeefc5c7a7ec">ComputeNext</a> (unsigned short _q) noexcept</td></tr>
<tr class="memdesc:ab74f3867f345e30ba236eeefc5c7a7ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the step size of the next step based on the error of the previous step.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab74f3867f345e30ba236eeefc5c7a7ec">More...</a><br /></td></tr>
<tr class="separator:ab74f3867f345e30ba236eeefc5c7a7ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e2cd45defdaac1b7bc2089e3542b38"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#af9e2cd45defdaac1b7bc2089e3542b38">ComputeTimeForValue</a> (const float _targetValue, const float _y0, const float _y1, const float _bsp[], const float _ks[], const unsigned _eqIdx, const unsigned short _order, const unsigned short _stage)</td></tr>
<tr class="memdesc:af9e2cd45defdaac1b7bc2089e3542b38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dichotomic search for the time at which <code>_targetValue</code> is reached.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#af9e2cd45defdaac1b7bc2089e3542b38">More...</a><br /></td></tr>
<tr class="separator:af9e2cd45defdaac1b7bc2089e3542b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0039dea9575cc205bf2da4fa18a939"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a6f0039dea9575cc205bf2da4fa18a939">ForceNext</a> (float _h) noexcept</td></tr>
<tr class="memdesc:a6f0039dea9575cc205bf2da4fa18a939"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forcefully increments the time by <code>_h</code>.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a6f0039dea9575cc205bf2da4fa18a939">More...</a><br /></td></tr>
<tr class="separator:a6f0039dea9575cc205bf2da4fa18a939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f844ecc4e33efbdb4bf29041a348a2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a02f844ecc4e33efbdb4bf29041a348a2">Next</a> () noexcept</td></tr>
<tr class="memdesc:a02f844ecc4e33efbdb4bf29041a348a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advances the time by <a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab71002b2b717e4d7b5e4edeea497394f" title="The step size of the next step.">h_next</a>.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a02f844ecc4e33efbdb4bf29041a348a2">More...</a><br /></td></tr>
<tr class="separator:a02f844ecc4e33efbdb4bf29041a348a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad4a19d4d41fb528213f49a9c051444"><td class="memItemLeft" align="right" valign="top"><a id="a6ad4a19d4d41fb528213f49a9c051444" name="a6ad4a19d4d41fb528213f49a9c051444"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>NextLEQ</b> (float _t) const noexcept</td></tr>
<tr class="memdesc:a6ad4a19d4d41fb528213f49a9c051444"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the next step is less than or equal to the given time. <br /></td></tr>
<tr class="separator:a6ad4a19d4d41fb528213f49a9c051444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b796ad8dfe9fb9756be36faa53e062"><td class="memItemLeft" align="right" valign="top"><a id="a59b796ad8dfe9fb9756be36faa53e062" name="a59b796ad8dfe9fb9756be36faa53e062"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>NextLE</b> (float _t) const noexcept</td></tr>
<tr class="memdesc:a59b796ad8dfe9fb9756be36faa53e062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the next step is less than the given time. <br /></td></tr>
<tr class="separator:a59b796ad8dfe9fb9756be36faa53e062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15996afe2021811a5862970d402b8422"><td class="memItemLeft" align="right" valign="top"><a id="a15996afe2021811a5862970d402b8422" name="a15996afe2021811a5862970d402b8422"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>NextGEQ</b> (float _t) const noexcept</td></tr>
<tr class="memdesc:a15996afe2021811a5862970d402b8422"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the next step is greater than or equal to the given time. <br /></td></tr>
<tr class="separator:a15996afe2021811a5862970d402b8422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cfd447420093e2f4bfda078a7a39c89"><td class="memItemLeft" align="right" valign="top"><a id="a2cfd447420093e2f4bfda078a7a39c89" name="a2cfd447420093e2f4bfda078a7a39c89"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>NextGE</b> (float _t) const noexcept</td></tr>
<tr class="memdesc:a2cfd447420093e2f4bfda078a7a39c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the next step is greater than the given time. <br /></td></tr>
<tr class="separator:a2cfd447420093e2f4bfda078a7a39c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab71002b2b717e4d7b5e4edeea497394f"><td class="memItemLeft" align="right" valign="top"><a id="ab71002b2b717e4d7b5e4edeea497394f" name="ab71002b2b717e4d7b5e4edeea497394f"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>h_next</b> = 0.001f</td></tr>
<tr class="memdesc:ab71002b2b717e4d7b5e4edeea497394f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The step size of the next step. <br /></td></tr>
<tr class="separator:ab71002b2b717e4d7b5e4edeea497394f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97002263de0c86b5b2db4edd22af8520"><td class="memItemLeft" align="right" valign="top"><a id="a97002263de0c86b5b2db4edd22af8520" name="a97002263de0c86b5b2db4edd22af8520"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>h_prev</b> = 0.001f</td></tr>
<tr class="memdesc:a97002263de0c86b5b2db4edd22af8520"><td class="mdescLeft">&#160;</td><td class="mdescRight">The step size of the previous step. <br /></td></tr>
<tr class="separator:a97002263de0c86b5b2db4edd22af8520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9057641d76a44a63bb1cd9335ae2ef66"><td class="memItemLeft" align="right" valign="top"><a id="a9057641d76a44a63bb1cd9335ae2ef66" name="a9057641d76a44a63bb1cd9335ae2ef66"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>t</b> = 0.f</td></tr>
<tr class="memdesc:a9057641d76a44a63bb1cd9335ae2ef66"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current time. <br /></td></tr>
<tr class="separator:a9057641d76a44a63bb1cd9335ae2ef66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a948d61584978a6323731b7229c4170be"><td class="memItemLeft" align="right" valign="top"><a id="a948d61584978a6323731b7229c4170be" name="a948d61584978a6323731b7229c4170be"></a>
const float&#160;</td><td class="memItemRight" valign="bottom"><b>fac</b> = 0.8f</td></tr>
<tr class="memdesc:a948d61584978a6323731b7229c4170be"><td class="mdescLeft">&#160;</td><td class="mdescRight">A parameter used to control the step size. <br /></td></tr>
<tr class="separator:a948d61584978a6323731b7229c4170be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa911f38a4ec5554cbe36eeacd2490e3b"><td class="memItemLeft" align="right" valign="top"><a id="aa911f38a4ec5554cbe36eeacd2490e3b" name="aa911f38a4ec5554cbe36eeacd2490e3b"></a>
const float&#160;</td><td class="memItemRight" valign="bottom"><b>facmax</b> = 5.f</td></tr>
<tr class="memdesc:aa911f38a4ec5554cbe36eeacd2490e3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value by which to multiply the step size on increase. <br /></td></tr>
<tr class="separator:aa911f38a4ec5554cbe36eeacd2490e3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eee041e534d277680aaa00a7fa9727c"><td class="memItemLeft" align="right" valign="top"><a id="a1eee041e534d277680aaa00a7fa9727c" name="a1eee041e534d277680aaa00a7fa9727c"></a>
const float&#160;</td><td class="memItemRight" valign="bottom"><b>facmin</b> = 0.2f</td></tr>
<tr class="memdesc:a1eee041e534d277680aaa00a7fa9727c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value by which to multiply the step size on decrease. <br /></td></tr>
<tr class="separator:a1eee041e534d277680aaa00a7fa9727c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82836a3e7af9c6e0e14aa5fc7a76e12"><td class="memItemLeft" align="right" valign="top"><a id="aa82836a3e7af9c6e0e14aa5fc7a76e12" name="aa82836a3e7af9c6e0e14aa5fc7a76e12"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>error</b> = 0.f</td></tr>
<tr class="memdesc:aa82836a3e7af9c6e0e14aa5fc7a76e12"><td class="mdescLeft">&#160;</td><td class="mdescRight">The error of the last step. <br /></td></tr>
<tr class="separator:aa82836a3e7af9c6e0e14aa5fc7a76e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad9f9783a6531a107a6d7f9d32c91c23"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#aad9f9783a6531a107a6d7f9d32c91c23">sc</a> = 0.f</td></tr>
<tr class="memdesc:aad9f9783a6531a107a6d7f9d32c91c23"><td class="mdescLeft">&#160;</td><td class="mdescRight">The scaling factor used to compute the error.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#aad9f9783a6531a107a6d7f9d32c91c23">More...</a><br /></td></tr>
<tr class="separator:aad9f9783a6531a107a6d7f9d32c91c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c6883c315a1681e626a4c45e9978d9f"><td class="memItemLeft" align="right" valign="top"><a id="a3c6883c315a1681e626a4c45e9978d9f" name="a3c6883c315a1681e626a4c45e9978d9f"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>absoluteTolerance</b> = 0.000001f</td></tr>
<tr class="memdesc:a3c6883c315a1681e626a4c45e9978d9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The absolute tolerance used to compute the error. <br /></td></tr>
<tr class="separator:a3c6883c315a1681e626a4c45e9978d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab097bff85dc643ad356bd8eac2b602ca"><td class="memItemLeft" align="right" valign="top"><a id="ab097bff85dc643ad356bd8eac2b602ca" name="ab097bff85dc643ad356bd8eac2b602ca"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>relativeTolerance</b> = 0.000001f</td></tr>
<tr class="memdesc:ab097bff85dc643ad356bd8eac2b602ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">The relative tolerance used to compute the error. <br /></td></tr>
<tr class="separator:ab097bff85dc643ad356bd8eac2b602ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6b8f16a40f16c42b434329924927947"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab6b8f16a40f16c42b434329924927947">computeTimeThetaTolerance</a> = 0.05f</td></tr>
<tr class="memdesc:ab6b8f16a40f16c42b434329924927947"><td class="mdescLeft">&#160;</td><td class="mdescRight">The tolerance used when looking for the time at which a value is reached.  <a href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab6b8f16a40f16c42b434329924927947">More...</a><br /></td></tr>
<tr class="separator:ab6b8f16a40f16c42b434329924927947"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Structure to control the step size of an ODE solver. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6f4d6dc7cc16fc7adc1eaa7097fb297a" name="a6f4d6dc7cc16fc7adc1eaa7097fb297a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f4d6dc7cc16fc7adc1eaa7097fb297a">&#9670;&#160;</a></span>ComputeDenseOutputIncrement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::ComputeDenseOutputIncrement </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_bsp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_ks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>_eqIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned short&#160;</td>
          <td class="paramname"><em>_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned short&#160;</td>
          <td class="paramname"><em>_stage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the dense output increment. </p>
<p >It is computed as: sum_{s=0}^{stage-1} sum_{j=0}^{order-1} b_{s,j} * theta^(j+1) * k_{eqIdx+s}. The stage-1 and order-1 are used because the arrays are 0-based. You must add this value to the values at the beginning of the step (y0) to get the interpolation at <code>_theta</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_bsp</td><td>The b_{s,j} coefficients of the polynom in _theta. </td></tr>
    <tr><td class="paramname">_theta</td><td>The value at which to compute the interpolation. It must be between 0 and 1. </td></tr>
    <tr><td class="paramname">_ks</td><td>The integration coefficients of the Runge-Kutta method. </td></tr>
    <tr><td class="paramname">_eqIdx</td><td>The index of the equation for which to compute the dense output increment. It is used to access the correct values in <code>_ks</code>. </td></tr>
    <tr><td class="paramname">_order</td><td>The order of the polynom in _theta. </td></tr>
    <tr><td class="paramname">_stage</td><td>The number of stages of the underlying Runge-Kutta method employed to solve the ODE. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab7bc6672affe2fc1cf7172b814d2ed3c" name="ab7bc6672affe2fc1cf7172b814d2ed3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7bc6672affe2fc1cf7172b814d2ed3c">&#9670;&#160;</a></span>ComputeDenseOutputTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::ComputeDenseOutputTime </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_t1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gives the position of <code>_t</code> in the interval [<code>_t0</code>, <code>_t1</code>] as a value between 0 and 1. </p>
<p >It is computed as: (_t - _t0) / (_t1 - _t0). Does not check if <code>_t</code> is in the interval. </p>

</div>
</div>
<a id="acd912a085784a578e3aab228d5e7c678" name="acd912a085784a578e3aab228d5e7c678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd912a085784a578e3aab228d5e7c678">&#9670;&#160;</a></span>ComputeError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ECellEngine::Solvers::ODE::Stepper::ComputeError </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_y0</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_yEst1</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_yEst2</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the error of the steps that produced the estimations stored in <code>_yEst1</code> and <code>_yEst2</code> from <code>_y0</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_y0</td><td>The values at the beginning of the step. </td></tr>
    <tr><td class="paramname">_yEst1</td><td>The first estimation of the values at the end of the step. </td></tr>
    <tr><td class="paramname">_yEst2</td><td>The second estimation of the values at the end of the step. </td></tr>
    <tr><td class="paramname">_count</td><td>The number of values in the arrays. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the error is less than 1. </dd></dl>

</div>
</div>
<a id="ab74f3867f345e30ba236eeefc5c7a7ec" name="ab74f3867f345e30ba236eeefc5c7a7ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab74f3867f345e30ba236eeefc5c7a7ec">&#9670;&#160;</a></span>ComputeNext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::ComputeNext </td>
          <td>(</td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>_q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the step size of the next step based on the error of the previous step. </p>
<p >You should call this function after <a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#acd912a085784a578e3aab228d5e7c678">ComputeError</a>. </p>

</div>
</div>
<a id="af9e2cd45defdaac1b7bc2089e3542b38" name="af9e2cd45defdaac1b7bc2089e3542b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9e2cd45defdaac1b7bc2089e3542b38">&#9670;&#160;</a></span>ComputeTimeForValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::ComputeTimeForValue </td>
          <td>(</td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_targetValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_bsp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>_ks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>_eqIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned short&#160;</td>
          <td class="paramname"><em>_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned short&#160;</td>
          <td class="paramname"><em>_stage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dichotomic search for the time at which <code>_targetValue</code> is reached. </p>
<p >The dichotomy is performed on the normalized difference between the target value and the value at the current theta. It iscomputed as abs((<code>_targetValue</code> - <code>_y0</code>) - <em>denseOutputIncrementAtTheta</em>)/(<code>_y1</code> - <code>_y0</code>). The search is stopped when the difference is less than <a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab6b8f16a40f16c42b434329924927947" title="The tolerance used when looking for the time at which a value is reached.">computeTimeThetaTolerance</a>. This is equivalent to searching for the theta at which the difference is less than (1/<a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab6b8f16a40f16c42b434329924927947" title="The tolerance used when looking for the time at which a value is reached.">computeTimeThetaTolerance</a>)-th of the step range [t, t + h_next]. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_targetValue</td><td>The value for which we want the time. </td></tr>
    <tr><td class="paramname">_y0</td><td>The value at the beginning of the step. </td></tr>
    <tr><td class="paramname">_y1</td><td>The value at the end of the step. </td></tr>
    <tr><td class="paramname">_bsp</td><td>The b_{s,j} coefficients of the polynom in theta. Used for the dense output increment. </td></tr>
    <tr><td class="paramname">_ks</td><td>The integration coefficients of the Runge-Kutta method. Used for the dense output increment. </td></tr>
    <tr><td class="paramname">_eqIdx</td><td>The index of the equation for which to compute the dense output increment. </td></tr>
    <tr><td class="paramname">_order</td><td>The order of the polynom in theta. Used for the dense output increment. </td></tr>
    <tr><td class="paramname">_stage</td><td>The number of stages of the underlying Runge-Kutta method. Used for the dense output increment. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6f0039dea9575cc205bf2da4fa18a939" name="a6f0039dea9575cc205bf2da4fa18a939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f0039dea9575cc205bf2da4fa18a939">&#9670;&#160;</a></span>ForceNext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ECellEngine::Solvers::ODE::Stepper::ForceNext </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forcefully increments the time by <code>_h</code>. </p>
<p >t += _h. Does not change the step size (<a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab71002b2b717e4d7b5e4edeea497394f" title="The step size of the next step.">h_next</a>) but updates the value of <a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#a97002263de0c86b5b2db4edd22af8520" title="The step size of the previous step.">h_prev</a>. </p>

</div>
</div>
<a id="a02f844ecc4e33efbdb4bf29041a348a2" name="a02f844ecc4e33efbdb4bf29041a348a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f844ecc4e33efbdb4bf29041a348a2">&#9670;&#160;</a></span>Next()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::Next </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Advances the time by <a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#ab71002b2b717e4d7b5e4edeea497394f" title="The step size of the next step.">h_next</a>. </p>
<p >t += h_next. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab6b8f16a40f16c42b434329924927947" name="ab6b8f16a40f16c42b434329924927947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6b8f16a40f16c42b434329924927947">&#9670;&#160;</a></span>computeTimeThetaTolerance</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::computeTimeThetaTolerance = 0.05f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The tolerance used when looking for the time at which a value is reached. </p>
<p >It is used in <a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html#af9e2cd45defdaac1b7bc2089e3542b38" title="Dichotomic search for the time at which _targetValue is reached.">ComputeTimeForValue(const float _targetValue, const float _y0, const float _y1, const float _bsp[], const float _ks[], const unsigned _eqIdx, const unsigned short _order, const unsigned short _stage)</a>. This is the tolerance on the parameter theta of the dense output on which we perform a dichotomic search. The search is stopped when the difference is less than this tolerance. </p>

</div>
</div>
<a id="aad9f9783a6531a107a6d7f9d32c91c23" name="aad9f9783a6531a107a6d7f9d32c91c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9f9783a6531a107a6d7f9d32c91c23">&#9670;&#160;</a></span>sc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ECellEngine::Solvers::ODE::Stepper::sc = 0.f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The scaling factor used to compute the error. </p>
<p >It is computed as: absoluteTolerance + relativeTolerance * max(|y0|, |yEst1|). </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>ECell_Engine/headers/Solver/ODE/<a class="el" href="_stepper_8hpp_source.html">Stepper.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>ECellEngine</b></li><li class="navelem"><b>Solvers</b></li><li class="navelem"><b>ODE</b></li><li class="navelem"><a class="el" href="struct_e_cell_engine_1_1_solvers_1_1_o_d_e_1_1_stepper.html">Stepper</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
